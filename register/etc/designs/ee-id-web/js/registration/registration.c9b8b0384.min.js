!function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){module.exports={$verifyEmailContentContainer:$("#verifyEmailContentContainer"),$notificationError:$(".notification--error"),$resendEmailForm:$("#resendEmailForm"),$captchaInput:$(".capture_text_input"),$resendEmailLink:$(".resendEmailLink"),$preloaderInit:$(".preloader--init"),$preloaderDone:$(".preloader--done"),$sendEmailNotificationDefault:$("#sendEmailNotificationDefault"),$notificationDefault:$("#notificationDefault"),$sendEmailNavigation:$("#sendEmailNavigation"),$resendSuccess:$("#resendSuccess"),$resendFailure:$("#resendFailure"),$resendFailureUnavailable:$("#resendFailureUnavailable"),$document:$(document)}},{}],2:[function(require,module,exports){var domElements=require("./dom-elements"),errorChecker={24:function(){domElements.$resendSuccess.hide(),domElements.$sendEmailNavigation.hide(),domElements.$resendFailureUnavailable.hide(),domElements.$resendFailure.fadeIn(),emailVerificationCtrl.hideCaptcha(),EE.Insights.generateInsights("API_ERROR_NOT_RECEIVED_EMAIL",{error:"api-error-not-received-email",event_association:"API_ERROR_NOT_RECEIVED_EMAIL",notificationStatus:"api-error-not-received-email"})},78:function(){window.reCaptcha.reset(),window.reCaptcha.triggerMessage("invalid_captcha",!0)},77:function(){domElements.$resendEmailLink.off("click").attr("data-toggle","collapse"),EE.main.toggleCollapse(domElements.$resendEmailLink),window.reCaptcha.reset()}},responseStatusChecker={200:function(){domElements.$verifyEmailContentContainer.fadeOut(function(){EE.main.scrollToElement($(".stepper"),20),domElements.$resendFailureUnavailable.fadeOut(),domElements.$resendFailure.fadeOut(),domElements.$preloaderInit.fadeIn().fadeOut(function(){domElements.$preloaderDone.fadeIn().delay(800).fadeOut(100).promise().done(emailVerificationCtrl.preloaderHelper),emailVerificationCtrl.hideSpinner()})}),EE.Insights.generateInsights("ACCOUNT_VERIFICATION_EMAIL_RESENT",{error:"",event_association:"ACCOUNT_VERIFICATION_EMAIL_RESENT",notificationStatus:"account-verification-email-resent"})},400:function(response){var errorCode=response.code;errorCode?errorChecker[errorCode]():errorChecker[24](),emailVerificationCtrl.hideSpinner()},500:function(){domElements.$resendSuccess.hide(),domElements.$sendEmailNavigation.hide(),domElements.$resendFailureUnavailable.hide(),domElements.$resendFailure.fadeIn(),emailVerificationCtrl.hideCaptcha(),emailVerificationCtrl.hideSpinner(),EE.Insights.generateInsights("API_ERROR_NOT_RECEIVED_EMAIL",{error:"api-error-not-received-email",event_association:"API_ERROR_NOT_RECEIVED_EMAIL",notificationStatus:"api-error-not-received-email"})},503:function(){domElements.$resendSuccess.hide(),domElements.$sendEmailNavigation.hide(),domElements.$resendFailure.hide(),domElements.$resendFailureUnavailable.fadeIn(),emailVerificationCtrl.hideCaptcha(),emailVerificationCtrl.hideSpinner(),EE.Insights.generateInsights("API_ERROR_NOT_RECEIVED_EMAIL",{error:"api-error-not-received-email",event_association:"API_ERROR_NOT_RECEIVED_EMAIL",notificationStatus:"api-error-not-received-email"})}},emailVerificationCtrl=function(){function checkStatus(status,response){status&&responseStatusChecker[status]?responseStatusChecker[status](response):responseStatusChecker[400](response)}function submitResendEmail(event){event.preventDefault(),EE.main.showSpinner($resendEmailBtn,!0);var requestData={username:email,"g-recaptcha-response":$("#g-recaptcha-response").val(),csrf:csrfValue};if(!EE.EEIDvalidation.validateForm(domElements.$resendEmailForm,!0))return void EE.main.hideSpinner($resendEmailBtn,!0);EE.userService.resendEmail(requestData).always(function(response){checkStatus(response.status,response)})}function resendEmailLinkHandler(event){event.preventDefault();var requestData={username:email,csrf:csrfValue};EE.userService.resendEmail(requestData).always(function(response){checkStatus(response.status,response)})}function preloaderHelper(){replaceNotificationContent(),hideCaptcha(),domElements.$sendEmailNavigation.show(),domElements.$resendSuccess.show()}function replaceNotificationContent(){var currentEmail=$("#emailAddress").val(),html=domElements.$resendSuccess.html();currentEmail&&(domElements.$resendSuccess.html(html.replace(new RegExp(emailPlaceHolder,"g"),currentEmail)),emailPlaceHolder=currentEmail),domElements.$resendSuccess.removeClass("is-hidden")}function hideCaptcha(){$('#captchaWrapper, [data-target="#captchaWrapper"]').removeClass("is-active"),window.reCaptcha.reset(),$("#notificationDefault").hide(),domElements.$sendEmailNotificationDefault.hide(),domElements.$verifyEmailContentContainer.fadeIn()}function hideSpinner(){EE.main.hideSpinner($resendEmailBtn,!0)}var emailPlaceHolder="{{email}}",email=$("#userEmail").val(),csrfValue=$("#csrf").val(),$resendEmailBtn=$("#email-verification__submit");return{submitResendEmail:submitResendEmail,resendEmailLinkHandler:resendEmailLinkHandler,preloaderHelper:preloaderHelper,hideCaptcha:hideCaptcha,hideSpinner:hideSpinner}}();module.exports=emailVerificationCtrl},{"./dom-elements":1}],3:[function(require,module,exports){window.EE=window.EE||{};var domElements=require("./dom-elements"),ctrl=require("./email-verification-ctrl"),emailVerification=function(){function init(){domElements.$document.on("eeid-collapse-closed",function(){window.reCaptcha.reset(),EE.EEIDvalidation.setAsValid(domElements.$captchaInput)}),domElements.$resendEmailForm.submit(ctrl.submitResendEmail),domElements.$resendEmailLink.on("click",ctrl.resendEmailLinkHandler)}var instance;return{getInstance:function(){return instance||(instance=init()),instance}}}();module.exports=emailVerification},{"./dom-elements":1,"./email-verification-ctrl":2}],4:[function(require,module,exports){var emailVerification=require("./emailverification/email-verification");window.EE=window.EE||{},function($,window,EE){"use strict";if(!EE.editMode){var captchaClone,waitingServerResponse=!1,state=window.currentState?window.currentState.current:{},emailPlaceHolder="{{email}}",$document=$(document),firstRegistrationAttempt=!0,captchaRequired=state.captchaRequired,settings={$passwordCheckPanel:$("#tooltip-password"),$messagePanelContainer:$(".message-panel-container"),$registrBtn:$("#registerBtn"),$confirmationPopup:$("#confirmationPopup"),$emailExistsNotification:$("#emailExistsNotification"),$emailAddressInput:$("#emailAddressInput"),$serverErrorWarning:$("#serverErrorWarning"),$serviceUnavailableErrorWarning:$("#serviceUnavailableErrorWarning"),$passwordInput:$("#passwordInput"),$successMessage:$("#successMessage")};EE.registrationflow={pageInit:function(){var self=this;emailVerification.getInstance(),captchaClone=$(".captcha").clone(),self.hideCaptcha(),$document.on("input_tooltip_show",self.inputTooltipShow).on("input_tooltip_hide",self.inputTooltipHide).on("blur","#emailAddressInput",self.showWhyRegisterPanel).on("click","#changeEmailLink",$.proxy(self.changeEmailLinkHandler,self)).on("focus","#registrationForm input",self.hideConfirmationPopup).on("keydown","#registrationForm input",$.proxy(self.validateBeforeSubmit,self)).on("keydown click","#registerBtn",$.proxy(self.validateBeforeSubmit,self)).on("click","#captchaTryAnotherCode",self.captchaRefreshInsight).on("submit","#registrationForm",$.proxy(self.handleFormSubmit,self)),$("#userRegistrationSpoofForm").bind("submit",self.formSpinner),"registration-association-pending"===state.stateName&&self.recheckAssociationStatus(),window.isFlex?self.passwordCheckList():EE.main.targetToggle("PASSWORD_STRENGTH_METER",$.proxy(self.passwordCheckList,self))},passwordCheckList:function(){var self=this;$document.on("focus","[data-pw-check]",self.showPasswordCheckPanel),window.isFlex?$document.on("blur","[data-pw-check]",self.hidePasswordCheckPanel):$document.on("blur","[data-pw-check], #showHidePassword",self.hidePasswordCheckPanel)},recheckAssociationStatus:function(){function handleAssociationSuccess(){$("#completeAssociationForm").submit()}function handleAssociationFailure(){$(".preloader--init").hide(),$("#pageWithTiles").show(),$("#addProductsFailureErr").show()}var requestData={csrf:$("#csrf").val()};setTimeout(function(){$.ajax({type:"POST",url:"/id/add-product?fa=checkForPendingRequest",data:requestData,encode:!0,success:function(response){response&&response.success?handleAssociationSuccess():handleAssociationFailure()},error:function(){handleAssociationFailure()}})},EE.properties.associationAsyncDelay)},validateBeforeSubmit:function(e){if((EE.Utils.isEnterKeyPressed(e)&&"createAccountBtn"!==e.target.id||"click"===e.type)&&(e.preventDefault(),$("#registerBtn").focus(),EE.EEIDvalidation.validateForm($("#registrationForm"),!0)))if(this.updateEmailInMessages(),window.isFlex){var $confirmBtn=$("#createAccountBtn");$confirmBtn.click()}else this.showConfirmMsg()},updateEmailInMessages:function(){var currentEmail=$("#emailAddressInput").val(),$confirmEmail=$("#confirmEmailContent"),html=$confirmEmail.html();$confirmEmail.html(html.replace(new RegExp(emailPlaceHolder,"g"),currentEmail)),$(".notification__text").each(function(){var htmlNotification=$(this).html();$(this).html(htmlNotification.replace(new RegExp(emailPlaceHolder,"g"),currentEmail))}),emailPlaceHolder=currentEmail},inputTooltipShow:function(e,data){"emailAddressInput"===data&&settings.$messagePanelContainer.hide()},inputTooltipHide:function(e,data){"emailAddressInput"===data&&settings.$emailExistsNotification.hide()},showConfirmMsg:function(){window.isFlex?EE.main.showSpinner($('#registerBtn[type="button"]'),!0).done(function(){EE.main.fadeInElement($("#confirmationPopup"))}):($('#registerBtn[type="button"]').prop("disabled",!0),$("#confirmationPopup").css("display","block"),EE.main.scrollToElement($("#registerBtn"),250),$("#changeEmailLink").focus(),$("#information-help-panels-mobile").hide())},changeEmailLinkHandler:function(event){event.preventDefault(),window.isFlex?EE.main.fadeOutElement($("#confirmationPopup"),$('#registerBtn[type="button"]'),!0).done(function(){$("#emailAddressInput").focus()}):($("#confirmationPopup").css("display","none"),$('#registerBtn[type="button"]').prop("disabled",!1),$("#emailAddressInput").focus())},showPasswordCheckPanel:function(){if(settings.$messagePanelContainer.hide(),settings.$emailExistsNotification.fadeOut(),settings.$passwordCheckPanel.show(),window.isFlex){var relatedInput=settings.$passwordInput.get(0);relatedInput.t&&clearTimeout(relatedInput.t),relatedInput.touched||window.setTimeout(function(){var indent;if(window.isFlex){var scale=window.visualViewport.scale,indentDefault=window.EE.isIos?80/scale:50;indent=scale>1?5:indentDefault}window.EE.EEIDvalidation.scrollAndFocus(settings.$passwordInput,indent)},100),relatedInput.touched=!0}},hidePasswordCheckPanel:function(e){if(!window.isFlex&&e.relatedTarget&&"passwordInput"!==e.relatedTarget.id&&"showHidePassword"!==e.relatedTarget.id&&(settings.$messagePanelContainer.show(),settings.$passwordCheckPanel.hide()),window.isFlex){var relatedInput=settings.$passwordInput.get(0);relatedInput.t=window.setTimeout(function(){settings.$passwordCheckPanel.hide()},5),relatedInput.touched=!1}},hideConfirmationPopup:function(){settings.$confirmationPopup.hide(),settings.$registrBtn.prop("disabled",!1)},formSpinner:function(e){if(e.preventDefault(),EE.EEIDvalidation.validateForm($("#userRegistrationSpoofForm"))){var self=this,$spoofSubmitButton=$("#spoofSubmitButton");EE.main.showSpinner($spoofSubmitButton,!0).done(function(){$(self).unbind("submit",EE.registrationflow.formSpinner),$(self).submit()})}},handleFormSubmit:function(event){var self=this,$confirmBtn=$("#createAccountBtn");event.preventDefault(),waitingServerResponse||(waitingServerResponse=!0,EE.main.setLastActiveDate(),EE.EEIDvalidation.validateForm($("#registrationForm"))&&($confirmBtn.prop("disabled",!0),EE.Insights.generateInsights({event:"REGISTRATION_INITIATED",event_registration:"",notificationStatus:""}),self.disableFormFields(!0),settings.$serverErrorWarning.hide(),EE.main.showSpinner($confirmBtn,!0).done(function(){self.submitRegistration()})))},submitRegistration:function(){function handleRegistrationSuccess(){window.isFlex&&self.showSuccessMessage();var $sessionForm=$("#registrationSessionForm"),captchaEvent=self.generateCaptchaInsight();if(firstRegistrationAttempt){var orderRoute="",eventLogin="LOGIN_SUCCESS_ID_DASHBOARD";EE.eeIdTracking&&"hbb-sales"===EE.eeIdTracking.destination&&(orderRoute="authenticated_id",eventLogin="LOGIN_SUCCESS");var notificationStatus="registration-success";window.isFlex&&(notificationStatus="flex-registration-is-success"),EE.Insights.generateInsights({event:"REGISTRATION_SUCCESS",event_captcha:captchaEvent,event_login:eventLogin,event_registration:"REGISTRATION_SUCCESS",loginStatus:"LoggedIn",notificationStatus:notificationStatus,orderRoute:orderRoute})}else{var notificationStatusResend="registration-success-resend";window.isFlex&&(notificationStatusResend="flex-registration-is-success"),EE.Insights.generateInsights({event:"REGISTRATION_SUCCESS",event_captcha:captchaEvent,event_registration:"REGISTRATION_SUCCESS",event_login:"LOGIN_SUCCESS_ID_DASHBOARD",notificationStatus:notificationStatusResend,loginStatus:"LoggedIn"})}window.isFlex?setTimeout(function(){$sessionForm.submit()},1600):$sessionForm.submit()}function handleRegistrationFailure(res){function handleInvalidFieldError(){var errorField=response.message&&response.message.split("Invalid body field: ")[1];window.isFlex&&EE.main.hideSpinner(settings.$registrBtn,!0);var fieldWrappers={firstName:$("#firstNameInput"),lastName:$("#lastNameInput"),email:$("#emailAddressInput"),password:$("#passwordInput"),captchaInput:$("#captcha_response_field")},ruleWrappers={firstName:"name",lastName:"name",email:"email",password:"password"};$("#contactNumberInput")&&(requestData.contactNo=$("#contactNumberInput"),ruleWrappers.contactNo="contactNumber"),"captchaInput"===errorField?handleCaptchaError():EE.EEIDvalidation.setAsInvalid(fieldWrappers[errorField],ruleWrappers[errorField]),fieldWrappers[errorField].val("")}function handleCaptchaError(){self.captchaRefreshInsight(),EE.main.reloadCaptcha(),EE.EEIDvalidation.setAsInvalid($("#captcha_response_field"),"required")}function handleCaptchaRequiredError(){$(captchaClone).insertAfter(".ee-checkbox"),window.Captcha&&Captcha.create("captcha_div",EE.captchaProps.theme,EE.captchaProps.url),captchaRequired=!0,self.captchaExceededAttemptsInsight(),EE.main.reloadCaptcha()}function handleEmailInUseError(){settings.$messagePanelContainer.hide(),captchaRequired&&EE.main.reloadCaptcha(),window.isFlex?EE.main.fadeInElement(settings.$emailExistsNotification):(settings.$emailExistsNotification.show(),EE.main.scrollToElement($("#emailExistsNotification"),10))}var response=res.responseJSON,errorCode=response.code,captchaMessage=self.generateCaptchaInsight(response);self.generateRegistrationFailureInsight(captchaMessage,"100"===errorCode),self.prepareFormToNextAttempt(),self.hideCaptcha(),function(){switch(errorCode){case"23":case"102":case"104":case"105":handleServerError();break;case"24":handleInvalidFieldError();break;case"100":handleEmailInUseError();break;case"103":handleCaptchaError();break;case"106":handleCaptchaRequiredError();break;default:;}}(),EE.main.scrollToFirstErrorField()}function handleServerError(){settings.$emailExistsNotification.hide();var captchaMessage=self.generateCaptchaInsight();self.generateRegistrationFailureInsight(captchaMessage),self.prepareFormToNextAttempt(),self.showServerError(),EE.main.reloadCaptcha()}function handleServiceUnavailableError(){var captchaMessage=self.generateCaptchaInsight();self.generateRegistrationFailureInsight(captchaMessage),self.prepareFormToNextAttempt(),self.showServiceUnavailableError(),EE.main.reloadCaptcha()}var self=this,requestData={requestId:$("#requestId").val(),email:$("#emailAddressInput").val(),password:$("#passwordInput").val(),firstName:$("#firstNameInput").val(),lastName:$("#lastNameInput").val(),rememberFlag:$("#rememberMeCheckbox").prop("checked")};$("#contactNumberInput")&&$("#contactNumberInput").val()&&(requestData.contactNo=$("#contactNumberInput").val().replace(/^07/,"447")),!0===captchaRequired&&(requestData.captchaExpectedAns=$("#captcha_question_field").val(),requestData.captchaInput=$("#captcha_response_field").val()),EE.userService.registerUser(requestData).always(function(response){switch(response.status){case 0:handleServerError();break;case 200:handleRegistrationSuccess();break;case 400:handleRegistrationFailure(response);break;case 405:handleServerError();break;case 503:handleServiceUnavailableError();break;case response.status<=599&&response.status>=500&&response.status:handleServerError()}})},disableFormFields:function(isReadOnly){$("#registrationForm :input").prop("readonly",isReadOnly),$("#rememberMeCheckbox").prop("disabled",isReadOnly)},hideConfirmationPopUp:function(){var $confirmationEmailPopup=$("#confirmationPopup"),$registerBtn=$("#registerBtn"),$confirmBtn=$("#createAccountBtn");EE.main.hideSpinner($confirmBtn),$confirmBtn.prop("disabled",!1),$confirmationEmailPopup.hide(),$registerBtn.prop("disabled",!1)},generateRegistrationFailureInsight:function(captchaEvent,isExistingEmail){var notificationStatus="registration-js-failure";window.isFlex&&(notificationStatus=isExistingEmail?"flex-existing-email-found":"flex-registration-is-failure"),EE.Insights.generateInsights({event:"REGISTRATION_FAILURE",event_captcha:captchaEvent,event_registration:"REGISTRATION_FAILURE",notificationStatus:notificationStatus}),firstRegistrationAttempt=!1},prepareFormToNextAttempt:function(){this.disableFormFields(!1),waitingServerResponse=!1,this.hideConfirmationPopUp()},showServerError:function(){window.isFlex?EE.main.fadeInElement(settings.$serverErrorWarning):(settings.$serverErrorWarning.fadeIn(),EE.main.scrollToElement(settings.$serverErrorWarning,100))},showServiceUnavailableError:function(){window.isFlex?EE.main.fadeInElement(settings.$serviceUnavailableErrorWarning):(settings.$serviceUnavailableErrorWarning.fadeIn(),EE.main.scrollToElement(settings.$serviceUnavailableErrorWarning,100))},showSuccessMessage:function(){EE.main.fadeInElement(settings.$successMessage)},hideCaptcha:function(){!1===captchaRequired||void 0===captchaRequired?$(".captcha").remove():window.Captcha&&Captcha.create("captcha_div",EE.captchaProps.theme,EE.captchaProps.url)},captchaRefreshInsight:function(){EE.Insights.generateInsights({event_captcha:"REGISTRATION_CONDITIONAL_CAPTCHA_DISPLAYED_REFRESH"})},captchaExceededAttemptsInsight:function(){EE.Insights.generateInsights({event_captcha:"REGISTRATION_CONDITIONAL_CAPTCHA_DISPLAYED_ATTEMPTS_EXCEEDED"})},generateCaptchaInsight:function(response){if(EE.eeIdTracking){var code=(EE.eeIdTracking.event_captcha,response?response.code:0);return captchaRequired&&103!==code?"REGISTRATION_CONDITIONAL_CAPTCHA_DISPLAYED_ACCEPTED":"REGISTRATION_CONDITIONAL_CAPTCHA_NOT_DISPLAYED_ATTEMPTS_NOT_EXCEEDED"}return null},showWhyRegisterPanel:function(){settings.$messagePanelContainer.show()}},EE.registrationflow.pageInit()}}($,window,EE)},{"./emailverification/email-verification":3}]},{},[4]);
//# sourceMappingURL=registration.c9b8b0384.min.js.map
