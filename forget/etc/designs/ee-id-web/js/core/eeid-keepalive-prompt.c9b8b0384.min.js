!function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){window.EE=window.EE||{},function($,window,EE){"use strict";function findHighestZIndex(elem){for(var elems=document.getElementsByTagName(elem),highest=Number.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),i=0;i<elems.length;i++){var zindex=Number.parseInt(document.defaultView.getComputedStyle(elems[i],null).getPropertyValue("z-index"),10);zindex>highest&&(highest=zindex)}return highest}function addListener(){window.addEventListener("storage",receiveMessage)}function receiveMessage(event){event.key===notifierKey&&hideKeepAliveModal()}function preventTab(){function handleKeyDown(event){if(event.shiftKey&&(isShiftPress=!0),9===event.keyCode||isShiftPress&&9===event.keyCode)switch(event.preventDefault(),event.target.id){case"ksaKeepLoggedIn":$("#ksaLogOut").focus();break;case"ksaLogOut":$("#ksaKeepLoggedIn").focus();break;default:return}}function handleKeyUp(event){event.shiftKey&&(isShiftPress=!1)}var isShiftPress;$("#ksaKeepLoggedIn, #ksaLogOut").on("keydown",handleKeyDown).on("keyup",handleKeyUp)}function setUpMarkup(response){$("body").append($(response)),$ksaModal=$("#IMFEKeepAliveModal"),$ksaModalLogoutForm=$("#ksaModalLogoutForm"),$ksaModalRevokeForm=$("#ksaModalRevokeForm"),$ksaModalLogoutForm.attr("action",EE.keepAlive.endpointLogOut),$ksaModalRevokeForm.attr("action",EE.keepAlive.endpointTimeout),pageAccessDelay=+EE.keepAlive.tFt||+$ksaModal.data("pageAccessDelay")-3e4}function setUpTimers(){window.localStorage[lastActivityField]=new Date,setInterval(checkLastActivity,1e3)}function startTrackUserActivity(){$("body").on("mousemove keydown blur focus touchstart click",updateUserLastActivity),$document.on("click keydown","#ksaLogOut",logoutUser),$document.on("click keydown","#ksaKeepLoggedIn",onKeepLoggedInClick)}function checkLastActivity(){new Date-new Date(window.localStorage[lastActivityField])>=+pageAccessDelay&&!isModalOpened&&showKeepAliveModal()}function updateUserLastActivity(){window.localStorage[lastActivityField]=new Date}function showKeepAliveModal(){var zIndex=findHighestZIndex("div")+10;$ksaModal.css("z-index",zIndex),$ksaModal.css("display","flex").fadeIn(function(){$("#ksaKeepLoggedIn").focus()}),$document.trigger("eeid:SHOW_KEEP_ALIVE_PROMPT"),isModalOpened=!0,ticker()}function hideKeepAliveModal(){$ksaModal.fadeOut(function(){isModalOpened=!1,clearInterval(tickerId),$("#ksaCounter").text(modalCountdown)})}function onKeepLoggedInClick(event){event.keyCode&&13!==event.keyCode||(event.preventDefault(),hideKeepAliveModal(),notifyOtherTabs())}function notifyOtherTabs(){window.localStorage.setItem(notifierKey,""),window.localStorage.removeItem(notifierKey)}function ticker(){var counter,startDate=new Date,$ksaCounter=$("#ksaCounter");tickerId=setInterval(function(){var now=new Date;counter=modalCountdown-Math.round((now-startDate)/1e3),counter<=0?(clearInterval(tickerId),revokeUserSession(),$ksaCounter.text("0")):$ksaCounter.text(counter)},1e3)}function logoutUser(event){event&&event.keyCode&&13!==event.keyCode||($document.trigger("eeid:SUCCESS_LOGOUT"),$ksaModalLogoutForm.submit())}function revokeUserSession(){$document.trigger("eeid:REVOKE_USER_SESSION"),$ksaModalRevokeForm.submit()}var lastActivityField=window.location.origin.slice(8)+"-eeIdLastActivity";if("false"!==window.EESSOSignIn&&function(){var test="testLocalStorage";try{return window.localStorage.setItem(test,test),window.localStorage.removeItem(test),!0}catch(e){return!1}}()){EE.properties=EE.properties||{},EE.keepAlive=EE.keepAlive||{},window.localStorage.removeItem("eeidLastActiveDate");var $ksaModal,$ksaModalLogoutForm,$ksaModalRevokeForm,tickerId,modalCountdown=30,pageAccessDelay=87e4,isModalOpened=!1,notifierKey="eeidStayLoggedInNotifier",$document=$(document);!function(){$.ajax({type:"GET",url:EE.keepAlive.originUrl+"/keepalive",encode:!0,success:function(response){setUpMarkup(response),setUpTimers(),startTrackUserActivity(),preventTab(),addListener()},error:function(){window.localStorage.removeItem(lastActivityField)}})}()}}(jQuery,window,EE)},{}]},{},[1]);
//# sourceMappingURL=eeid-keepalive-prompt.c9b8b0384.min.js.map
