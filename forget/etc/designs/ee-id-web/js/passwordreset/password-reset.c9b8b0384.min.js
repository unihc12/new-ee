!function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){window.EE=window.EE||{},window.reCaptcha=window.reCaptcha||{},function($,window,EE){"use strict";if(!EE.editMode){var passwordResetSuccessfulUrl;passwordResetSuccessfulUrl=EE.properties.features.VERIFY_EMAIL_RESULT_PAGE?"/id/verify-email-result":"/id/password-reset-successful";var settings={resendEmailUrl:"/id/reset-password",passwordResetSuccessfulUrl:passwordResetSuccessfulUrl},$emailInput=$("#email-address__input");EE.passwordResetflow={pageInit:function(){EE.Utils.MobileView.Any||$emailInput.focus(),EE.main.addSpinnerAndDisableAllBtnsWhenSubmitForm($("#password-reset__form"),$("#password-reset__submit"))},resendEmail:function(){var $resendEmailForm=$("#resendEmailForm"),$resendEmailBtn=$("#resendEmailForm__submit"),resendEmailNotification=document.getElementById("js-email-sent-notification"),apiErrorNotification=document.getElementById("password-email--api-error");$resendEmailForm.submit(function(e){if(e.preventDefault(),EE.EEIDvalidation.validateForm($resendEmailForm)){var el=$(this).data("preloader"),requestData={csrf:$("#csrf").val(),"g-recaptcha-response":$("#g-recaptcha-response").val(),email:$("#emailInput").val(),resendEmail:!0};EE.main.showSpinner($resendEmailBtn,!0).done(function(){$.ajax({type:"POST",url:settings.resendEmailUrl,crossDomain:!0,dataType:"json",data:requestData,encode:!0,complete:function(response){if(200===response.status)EE.main.scrollToElement($(".container--send-email"),20),$("#accordion-change-email").trigger("click"),EE.main.showSendEmailLoader(el).done(function(){apiErrorNotification.classList.add("display-none"),resendEmailNotification.classList.remove("display-none"),$("#captchaWrapper, [data-target='#captchaWrapper']").removeClass("is-active");var $resendEmailInput=$("#emailInput");$resendEmailInput.val(""),$resendEmailInput.parent().removeClass("form__group-element--valid"),$resendEmailInput.siblings(".form__icon--valid").addClass("hidden-important"),document.getElementById("check-email-notification__email")&&(document.getElementById("check-email-notification__email").innerHTML=requestData.email),window.reCaptcha.reset(),EE.main.hideSpinner($resendEmailBtn,!0)}),EE.Insights.generateInsights({event:"ForgotPasswordEmailResend",notificationStatus:"password-reset-email-sent-resend",event_email_verification:"RESEND_EMAIL_VERIFICATION"});else{var errorMessage=JSON.parse(response.responseText).message,errorCode=JSON.parse(response.responseText).code;"invalid_captcha"===errorMessage&&(window.reCaptcha.reset(),window.reCaptcha.triggerMessage(errorMessage,!0)),"01"!==errorCode&&"05"!==errorCode&&"100"!==errorCode||(apiErrorNotification.classList.remove("display-none"),resendEmailNotification.classList.add("display-none")),EE.Insights.generateInsights("RESEND_EMAIL_VERIFICATION_FAILED",{event_email_verification:""}),EE.main.hideSpinner($resendEmailBtn,!0)}}})})}})},newPassword:function(){$("#newPasswordForm").submit(function(event){function disableCancelButton(cancelButton){cancelButton.classList.add("disabled"),cancelButton.style.pointerEvents="none",cancelButton.style.cursor="default"}function resetPage(){newPasswordCancelButton.classList.remove("disabled"),newPasswordCancelButton.style.pointerEvents="auto",newPasswordCancelButton.style.cursor="pointer",EE.main.hideSpinner(newPasswordButton,!0),disableCancelButton(newPasswordCancelButton),EE.main.resetPasswordCheck($(".pw-check")),$("#new_password").val("")}function setPasswordComplete(response){if(200===response.status)window.location.href=settings.passwordResetSuccessfulUrl+"?setPassword";else if(resetPage(),$(".eeid-error").removeClass("eeid-error--visible"),$(".error-notification").hide(),response&&response.responseText){var errorCode=JSON.parse(response.responseText).code;switch(errorCode){case"01":case"61":case"100":case"23":case"24":$("#passwordSetWentWrong").fadeIn();break;case"103":$("#passwordSetLocked").fadeIn();break;case"05":case"68":$("#passwordSetBadContent").fadeIn();break;case"60":$("#passwordSetAccountNotFound").fadeIn();break;case"106":$("#passwordFormatInvalid").fadeIn();break;default:$("#passwordSetWentWrong").fadeIn()}}}function resetPasswordComplete(response){function handle500Errors(){resetPage(),$("#somethingsWrong").fadeIn()}var errorCode=response.responseText?JSON.parse(response.responseText).code:null;switch(function(){$("#passwordSetWentWrong").hide(),$("#duplicatedPasswordError").hide(),$("#userblockErrorNotification").hide(),$("#validPasswordError").hide(),$("#securePasswordError").hide(),$("#passwordFormatInvalid").hide(),$("#somethingsWrong").hide(),$("#passwordSetLocked").hide(),$("#passwordSetBadContent").hide(),$("#passwordSetAccountNotFound").hide()}(),response.status){case 200:!function(){EE.Insights.generateInsights("PASSWORD_RESET_SUCCESS",{event_email_verification:""}),$(".container--small").hide(),$(".preloader").show(),setTimeout(function(){window.location.href=settings.passwordResetSuccessfulUrl+"?newPassword"},EE.properties.resetPasswordAsyncDelay)}();break;case 400:!function(){switch(resetPage(),$(".page-body-info").hide(),errorCode){case"24":$("#validPasswordError").fadeIn();break;case"100":window.location.href=settings.resendEmailUrl+"?error=expiredPwdKey";break;case"101":$("#duplicatedPasswordError").fadeIn(),EE.Insights.generateInsights("FORGOTTEN_PASSWORD_EXISTING_MATCH",{event_password:"FORGOTTEN_PASSWORD_EXISTING_MATCH",error:"forgotten_password_password_previously_used",notificationStatus:"forgotten_password_password_previously_used",event_email_verification:""});break;case"106":$("#securePasswordError").fadeIn()}}();break;case 401:!function(){switch(EE.Insights.generateInsights("PASSWORD_RESET_FAILURE",{event_email_verification:""}),resetPage(),errorCode){case"102":case"103":$("#contentWrapper").hide(),$("#userblockErrorNotification").fadeIn()}}();break;case 500:default:handle500Errors()}}if(event.preventDefault(),EE.EEIDvalidation.validateForm($("#newPasswordForm"))){var url,completeCallBack,stateName=$("#stateName").val(),$passwordInput=$("#new_password"),password=$passwordInput.val(),resetPwdKey=$("#resetPwdKey").val(),applyPwdKey=$("#applyPwdKey").val(),data={newPassword1:password,newPassword2:password};"set-password"===stateName?(data.applyPwdKey=applyPwdKey,url=EE.properties.setPasswordEndpoint,completeCallBack=setPasswordComplete):(data.resetPwdKey=resetPwdKey,url=EE.properties.passwordResetEndpoint,completeCallBack=resetPasswordComplete);var newPasswordButton,newPasswordCancelButton,formData=JSON.stringify(data);$("#confirmChangePasswordBtn").length?(newPasswordButton=$("#confirmChangePasswordBtn"),newPasswordCancelButton=document.getElementById("edit-password-cancel-link"),disableCancelButton(newPasswordCancelButton)):$("#save-password-button").length&&(newPasswordButton=$("#save-password-button"),newPasswordCancelButton=document.getElementById("password-reset__cancel"),disableCancelButton(newPasswordCancelButton)),EE.main.showSpinner(newPasswordButton,!0).done(function(){$.ajax({url:url,dataType:"json",contentType:"application/json",type:"POST",data:formData,complete:completeCallBack})})}})}},EE.passwordResetflow.newPassword(),EE.passwordResetflow.pageInit(),EE.passwordResetflow.resendEmail()}}($,window,EE)},{}]},{},[1]);
//# sourceMappingURL=password-reset.c9b8b0384.min.js.map
